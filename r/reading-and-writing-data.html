<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Reading and Writing Data | Apache Arrow R Cookbook</title>
  <meta name="description" content="2 Reading and Writing Data | Apache Arrow R Cookbook" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Reading and Writing Data | Apache Arrow R Cookbook" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Reading and Writing Data | Apache Arrow R Cookbook" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="creating-arrow-objects.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface<span></span></a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#what-is-arrow"><i class="fa fa-check"></i><b>1.1</b> What is Arrow?<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#alternative-resources"><i class="fa fa-check"></i><b>1.2</b> Alternative resources<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html"><i class="fa fa-check"></i><b>2</b> Reading and Writing Data<span></span></a><ul>
<li class="chapter" data-level="2.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#convert-from-a-data-frame-to-an-arrow-table"><i class="fa fa-check"></i><b>2.2</b> Convert from a data frame to an Arrow Table<span></span></a><ul>
<li class="chapter" data-level="2.2.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution"><i class="fa fa-check"></i><b>2.2.1</b> Solution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#convert-data-from-an-arrow-table-to-a-data-frame"><i class="fa fa-check"></i><b>2.3</b> Convert data from an Arrow Table to a data frame<span></span></a><ul>
<li class="chapter" data-level="2.3.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution-1"><i class="fa fa-check"></i><b>2.3.1</b> Solution<span></span></a></li>
<li class="chapter" data-level="2.3.2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#discussion"><i class="fa fa-check"></i><b>2.3.2</b> Discussion<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#write-a-parquet-file"><i class="fa fa-check"></i><b>2.4</b> Write a Parquet file<span></span></a><ul>
<li class="chapter" data-level="2.4.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution-2"><i class="fa fa-check"></i><b>2.4.1</b> Solution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#read-a-parquet-file"><i class="fa fa-check"></i><b>2.5</b> Read a Parquet file<span></span></a><ul>
<li class="chapter" data-level="2.5.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution-3"><i class="fa fa-check"></i><b>2.5.1</b> Solution<span></span></a></li>
<li class="chapter" data-level="2.5.2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#discussion-1"><i class="fa fa-check"></i><b>2.5.2</b> Discussion<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#read-a-parquet-file-from-s3"><i class="fa fa-check"></i><b>2.6</b> Read a Parquet file from S3<span></span></a><ul>
<li class="chapter" data-level="2.6.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution-4"><i class="fa fa-check"></i><b>2.6.1</b> Solution<span></span></a></li>
<li class="chapter" data-level="2.6.2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#see-also"><i class="fa fa-check"></i><b>2.6.2</b> See also<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#filter-columns-while-reading-a-parquet-file"><i class="fa fa-check"></i><b>2.7</b> Filter columns while reading a Parquet file<span></span></a><ul>
<li class="chapter" data-level="2.7.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution-5"><i class="fa fa-check"></i><b>2.7.1</b> Solution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#write-an-ipcfeather-v2-file"><i class="fa fa-check"></i><b>2.8</b> Write an IPC/Feather V2 file<span></span></a><ul>
<li class="chapter" data-level="2.8.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution-6"><i class="fa fa-check"></i><b>2.8.1</b> Solution<span></span></a></li>
<li class="chapter" data-level="2.8.2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#discussion-2"><i class="fa fa-check"></i><b>2.8.2</b> Discussion<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#read-a-feather-file"><i class="fa fa-check"></i><b>2.9</b> Read a Feather file<span></span></a><ul>
<li class="chapter" data-level="2.9.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution-7"><i class="fa fa-check"></i><b>2.9.1</b> Solution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#write-streaming-ipc-files"><i class="fa fa-check"></i><b>2.10</b> Write streaming IPC files<span></span></a><ul>
<li class="chapter" data-level="2.10.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution-8"><i class="fa fa-check"></i><b>2.10.1</b> Solution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#read-streaming-ipc-files"><i class="fa fa-check"></i><b>2.11</b> Read streaming IPC files<span></span></a><ul>
<li class="chapter" data-level="2.11.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution-9"><i class="fa fa-check"></i><b>2.11.1</b> Solution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.12" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#read-csv-files"><i class="fa fa-check"></i><b>2.12</b> Read CSV files<span></span></a><ul>
<li class="chapter" data-level="2.12.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution-10"><i class="fa fa-check"></i><b>2.12.1</b> Solution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.13" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#write-csv-files"><i class="fa fa-check"></i><b>2.13</b> Write CSV files<span></span></a><ul>
<li class="chapter" data-level="2.13.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution-11"><i class="fa fa-check"></i><b>2.13.1</b> Solution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.14" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#read-json-files"><i class="fa fa-check"></i><b>2.14</b> Read JSON files<span></span></a><ul>
<li class="chapter" data-level="2.14.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution-12"><i class="fa fa-check"></i><b>2.14.1</b> Solution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.15" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#write-partitioned-data"><i class="fa fa-check"></i><b>2.15</b> Write partitioned data<span></span></a><ul>
<li class="chapter" data-level="2.15.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution-13"><i class="fa fa-check"></i><b>2.15.1</b> Solution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.16" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#read-partitioned-data"><i class="fa fa-check"></i><b>2.16</b> Read partitioned data<span></span></a><ul>
<li class="chapter" data-level="2.16.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution-14"><i class="fa fa-check"></i><b>2.16.1</b> Solution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.17" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#write-compressed-data"><i class="fa fa-check"></i><b>2.17</b> Write compressed data<span></span></a><ul>
<li class="chapter" data-level="2.17.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution-15"><i class="fa fa-check"></i><b>2.17.1</b> Solution<span></span></a></li>
<li class="chapter" data-level="2.17.2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#discussion-3"><i class="fa fa-check"></i><b>2.17.2</b> Discussion<span></span></a></li>
<li class="chapter" data-level="2.17.3" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#see-also-1"><i class="fa fa-check"></i><b>2.17.3</b> See also<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.18" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#read-compressed-data"><i class="fa fa-check"></i><b>2.18</b> Read compressed data<span></span></a><ul>
<li class="chapter" data-level="2.18.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution-16"><i class="fa fa-check"></i><b>2.18.1</b> Solution<span></span></a></li>
<li class="chapter" data-level="2.18.2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#discussion-4"><i class="fa fa-check"></i><b>2.18.2</b> Discussion<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="creating-arrow-objects.html"><a href="creating-arrow-objects.html"><i class="fa fa-check"></i><b>3</b> Creating Arrow Objects<span></span></a><ul>
<li class="chapter" data-level="3.1" data-path="creating-arrow-objects.html"><a href="creating-arrow-objects.html#create-an-arrow-array-from-an-r-object"><i class="fa fa-check"></i><b>3.1</b> Create an Arrow Array from an R object<span></span></a><ul>
<li class="chapter" data-level="3.1.1" data-path="creating-arrow-objects.html"><a href="creating-arrow-objects.html#solution-17"><i class="fa fa-check"></i><b>3.1.1</b> Solution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="creating-arrow-objects.html"><a href="creating-arrow-objects.html#create-a-arrow-table-from-an-r-object"><i class="fa fa-check"></i><b>3.2</b> Create a Arrow Table from an R object<span></span></a><ul>
<li class="chapter" data-level="3.2.1" data-path="creating-arrow-objects.html"><a href="creating-arrow-objects.html#solution-18"><i class="fa fa-check"></i><b>3.2.1</b> Solution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="creating-arrow-objects.html"><a href="creating-arrow-objects.html#view-the-contents-of-an-arrow-table-or-recordbatch"><i class="fa fa-check"></i><b>3.3</b> View the contents of an Arrow Table or RecordBatch<span></span></a><ul>
<li class="chapter" data-level="3.3.1" data-path="creating-arrow-objects.html"><a href="creating-arrow-objects.html#solution-19"><i class="fa fa-check"></i><b>3.3.1</b> Solution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="creating-arrow-objects.html"><a href="creating-arrow-objects.html#manually-create-a-recordbatch-from-an-r-object."><i class="fa fa-check"></i><b>3.4</b> Manually create a RecordBatch from an R object.<span></span></a><ul>
<li class="chapter" data-level="3.4.1" data-path="creating-arrow-objects.html"><a href="creating-arrow-objects.html#solution-20"><i class="fa fa-check"></i><b>3.4.1</b> Solution<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="defining-data-types.html"><a href="defining-data-types.html"><i class="fa fa-check"></i><b>4</b> Defining Data Types<span></span></a><ul>
<li class="chapter" data-level="4.1" data-path="defining-data-types.html"><a href="defining-data-types.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="defining-data-types.html"><a href="defining-data-types.html#update-data-type-of-an-existing-arrow-array"><i class="fa fa-check"></i><b>4.2</b> Update data type of an existing Arrow Array<span></span></a><ul>
<li class="chapter" data-level="4.2.1" data-path="defining-data-types.html"><a href="defining-data-types.html#solution-21"><i class="fa fa-check"></i><b>4.2.1</b> Solution<span></span></a></li>
<li class="chapter" data-level="4.2.2" data-path="defining-data-types.html"><a href="defining-data-types.html#discussion-5"><i class="fa fa-check"></i><b>4.2.2</b> Discussion<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="defining-data-types.html"><a href="defining-data-types.html#update-data-type-of-a-field-in-an-existing-arrow-table"><i class="fa fa-check"></i><b>4.3</b> Update data type of a field in an existing Arrow Table<span></span></a><ul>
<li class="chapter" data-level="4.3.1" data-path="defining-data-types.html"><a href="defining-data-types.html#solution-22"><i class="fa fa-check"></i><b>4.3.1</b> Solution<span></span></a></li>
<li class="chapter" data-level="4.3.2" data-path="defining-data-types.html"><a href="defining-data-types.html#no-compat-type"><i class="fa fa-check"></i><b>4.3.2</b> Discussion<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="defining-data-types.html"><a href="defining-data-types.html#specify-data-types-when-creating-an-arrow-table-from-an-r-object"><i class="fa fa-check"></i><b>4.4</b> Specify data types when creating an Arrow table from an R object<span></span></a><ul>
<li class="chapter" data-level="4.4.1" data-path="defining-data-types.html"><a href="defining-data-types.html#solution-23"><i class="fa fa-check"></i><b>4.4.1</b> Solution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="defining-data-types.html"><a href="defining-data-types.html#specify-data-types-when-reading-in-files"><i class="fa fa-check"></i><b>4.5</b> Specify data types when reading in files<span></span></a><ul>
<li class="chapter" data-level="4.5.1" data-path="defining-data-types.html"><a href="defining-data-types.html#solution-24"><i class="fa fa-check"></i><b>4.5.1</b> Solution<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="manipulating-data---arrays.html"><a href="manipulating-data---arrays.html"><i class="fa fa-check"></i><b>5</b> Manipulating Data - Arrays<span></span></a><ul>
<li class="chapter" data-level="5.1" data-path="manipulating-data---arrays.html"><a href="manipulating-data---arrays.html#introduction-2"><i class="fa fa-check"></i><b>5.1</b> Introduction<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="manipulating-data---arrays.html"><a href="manipulating-data---arrays.html#filter-by-values-matching-a-predicate-or-mask"><i class="fa fa-check"></i><b>5.2</b> Filter by values matching a predicate or mask<span></span></a><ul>
<li class="chapter" data-level="5.2.1" data-path="manipulating-data---arrays.html"><a href="manipulating-data---arrays.html#solution-25"><i class="fa fa-check"></i><b>5.2.1</b> Solution<span></span></a></li>
<li class="chapter" data-level="5.2.2" data-path="manipulating-data---arrays.html"><a href="manipulating-data---arrays.html#discussion-6"><i class="fa fa-check"></i><b>5.2.2</b> Discussion<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="manipulating-data---arrays.html"><a href="manipulating-data---arrays.html#compute-meanminmax-etc-value-of-an-array"><i class="fa fa-check"></i><b>5.3</b> Compute Mean/Min/Max, etc value of an Array<span></span></a><ul>
<li class="chapter" data-level="5.3.1" data-path="manipulating-data---arrays.html"><a href="manipulating-data---arrays.html#solution-26"><i class="fa fa-check"></i><b>5.3.1</b> Solution<span></span></a></li>
<li class="chapter" data-level="5.3.2" data-path="manipulating-data---arrays.html"><a href="manipulating-data---arrays.html#discussion-7"><i class="fa fa-check"></i><b>5.3.2</b> Discussion<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="manipulating-data---arrays.html"><a href="manipulating-data---arrays.html#count-occurrences-of-elements-in-an-array"><i class="fa fa-check"></i><b>5.4</b> Count occurrences of elements in an Array<span></span></a><ul>
<li class="chapter" data-level="5.4.1" data-path="manipulating-data---arrays.html"><a href="manipulating-data---arrays.html#solution-27"><i class="fa fa-check"></i><b>5.4.1</b> Solution<span></span></a></li>
<li class="chapter" data-level="5.4.2" data-path="manipulating-data---arrays.html"><a href="manipulating-data---arrays.html#discussion-8"><i class="fa fa-check"></i><b>5.4.2</b> Discussion<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="manipulating-data---arrays.html"><a href="manipulating-data---arrays.html#apply-arithmetic-functions-to-arrays."><i class="fa fa-check"></i><b>5.5</b> Apply arithmetic functions to Arrays.<span></span></a><ul>
<li class="chapter" data-level="5.5.1" data-path="manipulating-data---arrays.html"><a href="manipulating-data---arrays.html#solution-28"><i class="fa fa-check"></i><b>5.5.1</b> Solution<span></span></a></li>
<li class="chapter" data-level="5.5.2" data-path="manipulating-data---arrays.html"><a href="manipulating-data---arrays.html#discussion-9"><i class="fa fa-check"></i><b>5.5.2</b> Discussion<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="manipulating-data---arrays.html"><a href="manipulating-data---arrays.html#call-arrow-compute-functions-directly-on-arrays"><i class="fa fa-check"></i><b>5.6</b> Call Arrow compute functions directly on Arrays<span></span></a><ul>
<li class="chapter" data-level="5.6.1" data-path="manipulating-data---arrays.html"><a href="manipulating-data---arrays.html#solution-29"><i class="fa fa-check"></i><b>5.6.1</b> Solution<span></span></a></li>
<li class="chapter" data-level="5.6.2" data-path="manipulating-data---arrays.html"><a href="manipulating-data---arrays.html#discussion-10"><i class="fa fa-check"></i><b>5.6.2</b> Discussion<span></span></a></li>
<li class="chapter" data-level="5.6.3" data-path="manipulating-data---arrays.html"><a href="manipulating-data---arrays.html#see-also-2"><i class="fa fa-check"></i><b>5.6.3</b> See also<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="manipulating-data---tables.html"><a href="manipulating-data---tables.html"><i class="fa fa-check"></i><b>6</b> Manipulating Data - Tables<span></span></a><ul>
<li class="chapter" data-level="6.1" data-path="manipulating-data---tables.html"><a href="manipulating-data---tables.html#introduction-3"><i class="fa fa-check"></i><b>6.1</b> Introduction<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="manipulating-data---tables.html"><a href="manipulating-data---tables.html#use-dplyr-verbs-in-arrow"><i class="fa fa-check"></i><b>6.2</b> Use dplyr verbs in arrow<span></span></a><ul>
<li class="chapter" data-level="6.2.1" data-path="manipulating-data---tables.html"><a href="manipulating-data---tables.html#solution-30"><i class="fa fa-check"></i><b>6.2.1</b> Solution<span></span></a></li>
<li class="chapter" data-level="6.2.2" data-path="manipulating-data---tables.html"><a href="manipulating-data---tables.html#discussion-11"><i class="fa fa-check"></i><b>6.2.2</b> Discussion<span></span></a></li>
<li class="chapter" data-level="6.2.3" data-path="manipulating-data---tables.html"><a href="manipulating-data---tables.html#see-also-3"><i class="fa fa-check"></i><b>6.2.3</b> See also<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="manipulating-data---tables.html"><a href="manipulating-data---tables.html#use-r-functions-in-dplyr-verbs-in-arrow"><i class="fa fa-check"></i><b>6.3</b> Use R functions in dplyr verbs in arrow<span></span></a><ul>
<li class="chapter" data-level="6.3.1" data-path="manipulating-data---tables.html"><a href="manipulating-data---tables.html#solution-31"><i class="fa fa-check"></i><b>6.3.1</b> Solution<span></span></a></li>
<li class="chapter" data-level="6.3.2" data-path="manipulating-data---tables.html"><a href="manipulating-data---tables.html#discussion-12"><i class="fa fa-check"></i><b>6.3.2</b> Discussion<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="manipulating-data---tables.html"><a href="manipulating-data---tables.html#use-arrow-functions-in-dplyr-verbs-in-arrow"><i class="fa fa-check"></i><b>6.4</b> Use arrow functions in dplyr verbs in arrow<span></span></a><ul>
<li class="chapter" data-level="6.4.1" data-path="manipulating-data---tables.html"><a href="manipulating-data---tables.html#solution-32"><i class="fa fa-check"></i><b>6.4.1</b> Solution<span></span></a></li>
<li class="chapter" data-level="6.4.2" data-path="manipulating-data---tables.html"><a href="manipulating-data---tables.html#discussion-13"><i class="fa fa-check"></i><b>6.4.2</b> Discussion<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="using-pyarrow-from-r.html"><a href="using-pyarrow-from-r.html"><i class="fa fa-check"></i><b>7</b> Using PyArrow from R<span></span></a><ul>
<li class="chapter" data-level="7.1" data-path="using-pyarrow-from-r.html"><a href="using-pyarrow-from-r.html#introduction-4"><i class="fa fa-check"></i><b>7.1</b> Introduction<span></span></a></li>
<li class="chapter" data-level="7.2" data-path="using-pyarrow-from-r.html"><a href="using-pyarrow-from-r.html#create-an-arrow-object-using-pyarrow-in-r"><i class="fa fa-check"></i><b>7.2</b> Create an Arrow object using PyArrow in R<span></span></a><ul>
<li class="chapter" data-level="7.2.1" data-path="using-pyarrow-from-r.html"><a href="using-pyarrow-from-r.html#solution-33"><i class="fa fa-check"></i><b>7.2.1</b> Solution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="using-pyarrow-from-r.html"><a href="using-pyarrow-from-r.html#call-a-pyarrow-function-from-r"><i class="fa fa-check"></i><b>7.3</b> Call a PyArrow function from R<span></span></a><ul>
<li class="chapter" data-level="7.3.1" data-path="using-pyarrow-from-r.html"><a href="using-pyarrow-from-r.html#solution-34"><i class="fa fa-check"></i><b>7.3.1</b> Solution<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="flight.html"><a href="flight.html"><i class="fa fa-check"></i><b>8</b> Flight<span></span></a><ul>
<li class="chapter" data-level="8.1" data-path="flight.html"><a href="flight.html#introduction-5"><i class="fa fa-check"></i><b>8.1</b> Introduction<span></span></a></li>
<li class="chapter" data-level="8.2" data-path="flight.html"><a href="flight.html#connect-to-a-flight-server"><i class="fa fa-check"></i><b>8.2</b> Connect to a Flight server<span></span></a><ul>
<li class="chapter" data-level="8.2.1" data-path="flight.html"><a href="flight.html#solution-35"><i class="fa fa-check"></i><b>8.2.1</b> Solution<span></span></a></li>
<li class="chapter" data-level="8.2.2" data-path="flight.html"><a href="flight.html#see-also-4"><i class="fa fa-check"></i><b>8.2.2</b> See also<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="flight.html"><a href="flight.html#send-data-to-a-flight-server"><i class="fa fa-check"></i><b>8.3</b> Send data to a Flight server<span></span></a><ul>
<li class="chapter" data-level="8.3.1" data-path="flight.html"><a href="flight.html#solution-36"><i class="fa fa-check"></i><b>8.3.1</b> Solution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="flight.html"><a href="flight.html#check-what-resources-exist-on-a-flight-server"><i class="fa fa-check"></i><b>8.4</b> Check what resources exist on a Flight server<span></span></a><ul>
<li class="chapter" data-level="8.4.1" data-path="flight.html"><a href="flight.html#solution-37"><i class="fa fa-check"></i><b>8.4.1</b> Solution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="flight.html"><a href="flight.html#retrieve-data-from-a-flight-server"><i class="fa fa-check"></i><b>8.5</b> Retrieve data from a Flight server<span></span></a><ul>
<li class="chapter" data-level="8.5.1" data-path="flight.html"><a href="flight.html#solution-38"><i class="fa fa-check"></i><b>8.5.1</b> Solution<span></span></a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Apache Arrow R Cookbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="reading-and-writing-data" class="section level1 hasAnchor">
<h1><span class="header-section-number">2</span> Reading and Writing Data<a href="reading-and-writing-data.html#reading-and-writing-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.1</span> Introduction<a href="reading-and-writing-data.html#introduction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This chapter contains recipes related to reading and writing data using Apache
Arrow. When reading files into R using Apache Arrow, you can choose to read in
your file as either a data frame or as an Arrow Table object.</p>
<p>There are a number of circumstances in which you may want to read in the data as an Arrow Table:</p>
<ul>
<li>your dataset is large and if you load it into memory, it may lead to performance issues</li>
<li>you want faster performance from your <code>dplyr</code> queries</li>
<li>you want to be able to take advantage of Arrow’s compute functions</li>
</ul>
</div>
<div id="convert-from-a-data-frame-to-an-arrow-table" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.2</span> Convert from a data frame to an Arrow Table<a href="reading-and-writing-data.html#convert-from-a-data-frame-to-an-arrow-table" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You want to convert an existing <code>data.frame</code> or <code>tibble</code> object into an Arrow Table.</p>
<div id="solution" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.2.1</span> Solution<a href="reading-and-writing-data.html#solution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="reading-and-writing-data.html#cb1-1"></a>air_table &lt;-<span class="st"> </span><span class="kw">arrow_table</span>(airquality)</span>
<span id="cb1-2"><a href="reading-and-writing-data.html#cb1-2"></a>air_table</span></code></pre></div>
<pre><code>## Table
## 153 rows x 6 columns
## $Ozone &lt;int32&gt;
## $Solar.R &lt;int32&gt;
## $Wind &lt;double&gt;
## $Temp &lt;int32&gt;
## $Month &lt;int32&gt;
## $Day &lt;int32&gt;
## 
## See $metadata for additional Schema metadata</code></pre>
</div>
</div>
<div id="convert-data-from-an-arrow-table-to-a-data-frame" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.3</span> Convert data from an Arrow Table to a data frame<a href="reading-and-writing-data.html#convert-data-from-an-arrow-table-to-a-data-frame" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You want to convert an Arrow Table to a data frame to view the data or work with it
in your usual analytics pipeline.</p>
<div id="solution-1" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.3.1</span> Solution<a href="reading-and-writing-data.html#solution-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="reading-and-writing-data.html#cb3-1"></a>air_df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(air_table)</span>
<span id="cb3-2"><a href="reading-and-writing-data.html#cb3-2"></a>air_df</span></code></pre></div>
<pre><code>##     Ozone Solar.R Wind Temp Month Day
## 1      41     190  7.4   67     5   1
## 2      36     118  8.0   72     5   2
## 3      12     149 12.6   74     5   3
## 4      18     313 11.5   62     5   4
## 5      NA      NA 14.3   56     5   5
## 6      28      NA 14.9   66     5   6
## 7      23     299  8.6   65     5   7
## 8      19      99 13.8   59     5   8
## 9       8      19 20.1   61     5   9
## 10     NA     194  8.6   69     5  10
## 11      7      NA  6.9   74     5  11
## 12     16     256  9.7   69     5  12
## 13     11     290  9.2   66     5  13
## 14     14     274 10.9   68     5  14
## 15     18      65 13.2   58     5  15
## 16     14     334 11.5   64     5  16
## 17     34     307 12.0   66     5  17
## 18      6      78 18.4   57     5  18
## 19     30     322 11.5   68     5  19
## 20     11      44  9.7   62     5  20
## 21      1       8  9.7   59     5  21
## 22     11     320 16.6   73     5  22
## 23      4      25  9.7   61     5  23
## 24     32      92 12.0   61     5  24
## 25     NA      66 16.6   57     5  25
## 26     NA     266 14.9   58     5  26
## 27     NA      NA  8.0   57     5  27
## 28     23      13 12.0   67     5  28
## 29     45     252 14.9   81     5  29
## 30    115     223  5.7   79     5  30
## 31     37     279  7.4   76     5  31
## 32     NA     286  8.6   78     6   1
## 33     NA     287  9.7   74     6   2
## 34     NA     242 16.1   67     6   3
## 35     NA     186  9.2   84     6   4
## 36     NA     220  8.6   85     6   5
## 37     NA     264 14.3   79     6   6
## 38     29     127  9.7   82     6   7
## 39     NA     273  6.9   87     6   8
## 40     71     291 13.8   90     6   9
## 41     39     323 11.5   87     6  10
## 42     NA     259 10.9   93     6  11
## 43     NA     250  9.2   92     6  12
## 44     23     148  8.0   82     6  13
## 45     NA     332 13.8   80     6  14
## 46     NA     322 11.5   79     6  15
## 47     21     191 14.9   77     6  16
## 48     37     284 20.7   72     6  17
## 49     20      37  9.2   65     6  18
## 50     12     120 11.5   73     6  19
## 51     13     137 10.3   76     6  20
## 52     NA     150  6.3   77     6  21
## 53     NA      59  1.7   76     6  22
## 54     NA      91  4.6   76     6  23
## 55     NA     250  6.3   76     6  24
## 56     NA     135  8.0   75     6  25
## 57     NA     127  8.0   78     6  26
## 58     NA      47 10.3   73     6  27
## 59     NA      98 11.5   80     6  28
## 60     NA      31 14.9   77     6  29
## 61     NA     138  8.0   83     6  30
## 62    135     269  4.1   84     7   1
## 63     49     248  9.2   85     7   2
## 64     32     236  9.2   81     7   3
## 65     NA     101 10.9   84     7   4
## 66     64     175  4.6   83     7   5
## 67     40     314 10.9   83     7   6
## 68     77     276  5.1   88     7   7
## 69     97     267  6.3   92     7   8
## 70     97     272  5.7   92     7   9
## 71     85     175  7.4   89     7  10
## 72     NA     139  8.6   82     7  11
## 73     10     264 14.3   73     7  12
## 74     27     175 14.9   81     7  13
## 75     NA     291 14.9   91     7  14
## 76      7      48 14.3   80     7  15
## 77     48     260  6.9   81     7  16
## 78     35     274 10.3   82     7  17
## 79     61     285  6.3   84     7  18
## 80     79     187  5.1   87     7  19
## 81     63     220 11.5   85     7  20
## 82     16       7  6.9   74     7  21
## 83     NA     258  9.7   81     7  22
## 84     NA     295 11.5   82     7  23
## 85     80     294  8.6   86     7  24
## 86    108     223  8.0   85     7  25
## 87     20      81  8.6   82     7  26
## 88     52      82 12.0   86     7  27
## 89     82     213  7.4   88     7  28
## 90     50     275  7.4   86     7  29
## 91     64     253  7.4   83     7  30
## 92     59     254  9.2   81     7  31
## 93     39      83  6.9   81     8   1
## 94      9      24 13.8   81     8   2
## 95     16      77  7.4   82     8   3
## 96     78      NA  6.9   86     8   4
## 97     35      NA  7.4   85     8   5
## 98     66      NA  4.6   87     8   6
## 99    122     255  4.0   89     8   7
## 100    89     229 10.3   90     8   8
## 101   110     207  8.0   90     8   9
## 102    NA     222  8.6   92     8  10
## 103    NA     137 11.5   86     8  11
## 104    44     192 11.5   86     8  12
## 105    28     273 11.5   82     8  13
## 106    65     157  9.7   80     8  14
## 107    NA      64 11.5   79     8  15
## 108    22      71 10.3   77     8  16
## 109    59      51  6.3   79     8  17
## 110    23     115  7.4   76     8  18
## 111    31     244 10.9   78     8  19
## 112    44     190 10.3   78     8  20
## 113    21     259 15.5   77     8  21
## 114     9      36 14.3   72     8  22
## 115    NA     255 12.6   75     8  23
## 116    45     212  9.7   79     8  24
## 117   168     238  3.4   81     8  25
## 118    73     215  8.0   86     8  26
## 119    NA     153  5.7   88     8  27
## 120    76     203  9.7   97     8  28
## 121   118     225  2.3   94     8  29
## 122    84     237  6.3   96     8  30
## 123    85     188  6.3   94     8  31
## 124    96     167  6.9   91     9   1
## 125    78     197  5.1   92     9   2
## 126    73     183  2.8   93     9   3
## 127    91     189  4.6   93     9   4
## 128    47      95  7.4   87     9   5
## 129    32      92 15.5   84     9   6
## 130    20     252 10.9   80     9   7
## 131    23     220 10.3   78     9   8
## 132    21     230 10.9   75     9   9
## 133    24     259  9.7   73     9  10
## 134    44     236 14.9   81     9  11
## 135    21     259 15.5   76     9  12
## 136    28     238  6.3   77     9  13
## 137     9      24 10.9   71     9  14
## 138    13     112 11.5   71     9  15
## 139    46     237  6.9   78     9  16
## 140    18     224 13.8   67     9  17
## 141    13      27 10.3   76     9  18
## 142    24     238 10.3   68     9  19
## 143    16     201  8.0   82     9  20
## 144    13     238 12.6   64     9  21
## 145    23      14  9.2   71     9  22
## 146    36     139 10.3   81     9  23
## 147     7      49 10.3   69     9  24
## 148    14      20 16.6   63     9  25
## 149    30     193  6.9   70     9  26
## 150    NA     145 13.2   77     9  27
## 151    14     191 14.3   75     9  28
## 152    18     131  8.0   76     9  29
## 153    20     223 11.5   68     9  30</code></pre>
</div>
<div id="discussion" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.3.2</span> Discussion<a href="reading-and-writing-data.html#discussion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can use either <code>as.data.frame()</code> or <code>dplyr::collect()</code> to do this.</p>
</div>
</div>
<div id="write-a-parquet-file" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.4</span> Write a Parquet file<a href="reading-and-writing-data.html#write-a-parquet-file" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You want to write Parquet files to disk.</p>
<div id="solution-2" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.4.1</span> Solution<a href="reading-and-writing-data.html#solution-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="reading-and-writing-data.html#cb5-1"></a><span class="co"># Create table</span></span>
<span id="cb5-2"><a href="reading-and-writing-data.html#cb5-2"></a>my_table &lt;-<span class="st"> </span><span class="kw">arrow_table</span>(<span class="kw">data.frame</span>(<span class="dt">group =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>), <span class="dt">score =</span> <span class="kw">c</span>(<span class="dv">99</span>, <span class="dv">97</span>, <span class="dv">99</span>)))</span>
<span id="cb5-3"><a href="reading-and-writing-data.html#cb5-3"></a><span class="co"># Write to Parquet</span></span>
<span id="cb5-4"><a href="reading-and-writing-data.html#cb5-4"></a><span class="kw">write_parquet</span>(my_table, <span class="st">&quot;my_table.parquet&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="read-a-parquet-file" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.5</span> Read a Parquet file<a href="reading-and-writing-data.html#read-a-parquet-file" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You want to read a Parquet file.</p>
<div id="solution-3" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.5.1</span> Solution<a href="reading-and-writing-data.html#solution-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="reading-and-writing-data.html#cb6-1"></a>parquet_tbl &lt;-<span class="st"> </span><span class="kw">read_parquet</span>(<span class="st">&quot;my_table.parquet&quot;</span>)</span>
<span id="cb6-2"><a href="reading-and-writing-data.html#cb6-2"></a>parquet_tbl</span></code></pre></div>
<pre><code>##   group score
## 1     A    99
## 2     B    97
## 3     C    99</code></pre>
<p>As the argument <code>as_data_frame</code> was left set to its default value of <code>TRUE</code>, the file was read in as a <code>data.frame</code> object.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="reading-and-writing-data.html#cb8-1"></a><span class="kw">class</span>(parquet_tbl)</span></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
</div>
<div id="discussion-1" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.5.2</span> Discussion<a href="reading-and-writing-data.html#discussion-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you set <code>as_data_frame</code> to <code>FALSE</code>, the file will be read in as an Arrow Table.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="reading-and-writing-data.html#cb10-1"></a>my_table_arrow &lt;-<span class="st"> </span><span class="kw">read_parquet</span>(<span class="st">&quot;my_table.parquet&quot;</span>, <span class="dt">as_data_frame =</span> <span class="ot">FALSE</span>)</span>
<span id="cb10-2"><a href="reading-and-writing-data.html#cb10-2"></a>my_table_arrow</span></code></pre></div>
<pre><code>## Table
## 3 rows x 2 columns
## $group &lt;string&gt;
## $score &lt;double&gt;
## 
## See $metadata for additional Schema metadata</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="reading-and-writing-data.html#cb12-1"></a><span class="kw">class</span>(my_table_arrow)</span></code></pre></div>
<pre><code>## [1] &quot;Table&quot;        &quot;ArrowTabular&quot; &quot;ArrowObject&quot;  &quot;R6&quot;</code></pre>
</div>
</div>
<div id="read-a-parquet-file-from-s3" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.6</span> Read a Parquet file from S3<a href="reading-and-writing-data.html#read-a-parquet-file-from-s3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You want to read a Parquet file from S3.</p>
<div id="solution-4" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.6.1</span> Solution<a href="reading-and-writing-data.html#solution-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="reading-and-writing-data.html#cb14-1"></a>df &lt;-<span class="st"> </span><span class="kw">read_parquet</span>(<span class="dt">file =</span> <span class="st">&quot;s3://ursa-labs-taxi-data/2019/06/data.parquet&quot;</span>)</span></code></pre></div>
</div>
<div id="see-also" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.6.2</span> See also<a href="reading-and-writing-data.html#see-also" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For more in-depth instructions, including how to work with S3 buckets which require authentication, you can find a guide to reading and writing to/from S3 buckets here: <a href="https://arrow.apache.org/docs/r/articles/fs.html" class="uri">https://arrow.apache.org/docs/r/articles/fs.html</a>.</p>
</div>
</div>
<div id="filter-columns-while-reading-a-parquet-file" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.7</span> Filter columns while reading a Parquet file<a href="reading-and-writing-data.html#filter-columns-while-reading-a-parquet-file" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You want to specify which columns to include when reading in a Parquet file.</p>
<div id="solution-5" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.7.1</span> Solution<a href="reading-and-writing-data.html#solution-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="reading-and-writing-data.html#cb15-1"></a><span class="co"># Create table to read back in </span></span>
<span id="cb15-2"><a href="reading-and-writing-data.html#cb15-2"></a>dist_time &lt;-<span class="st"> </span><span class="kw">arrow_table</span>(<span class="kw">data.frame</span>(<span class="dt">distance =</span> <span class="kw">c</span>(<span class="fl">12.2</span>, <span class="fl">15.7</span>, <span class="fl">14.2</span>), <span class="dt">time =</span> <span class="kw">c</span>(<span class="dv">43</span>, <span class="dv">44</span>, <span class="dv">40</span>)))</span>
<span id="cb15-3"><a href="reading-and-writing-data.html#cb15-3"></a><span class="co"># Write to Parquet</span></span>
<span id="cb15-4"><a href="reading-and-writing-data.html#cb15-4"></a><span class="kw">write_parquet</span>(dist_time, <span class="st">&quot;dist_time.parquet&quot;</span>)</span>
<span id="cb15-5"><a href="reading-and-writing-data.html#cb15-5"></a></span>
<span id="cb15-6"><a href="reading-and-writing-data.html#cb15-6"></a><span class="co"># Read in only the &quot;time&quot; column</span></span>
<span id="cb15-7"><a href="reading-and-writing-data.html#cb15-7"></a>time_only &lt;-<span class="st"> </span><span class="kw">read_parquet</span>(<span class="st">&quot;dist_time.parquet&quot;</span>, <span class="dt">col_select =</span> <span class="st">&quot;time&quot;</span>)</span>
<span id="cb15-8"><a href="reading-and-writing-data.html#cb15-8"></a>time_only</span></code></pre></div>
<pre><code>##   time
## 1   43
## 2   44
## 3   40</code></pre>
</div>
</div>
<div id="write-an-ipcfeather-v2-file" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.8</span> Write an IPC/Feather V2 file<a href="reading-and-writing-data.html#write-an-ipcfeather-v2-file" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You want to read in a Feather file.</p>
<div id="solution-6" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.8.1</span> Solution<a href="reading-and-writing-data.html#solution-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="reading-and-writing-data.html#cb17-1"></a>my_table &lt;-<span class="st"> </span><span class="kw">arrow_table</span>(<span class="kw">data.frame</span>(<span class="dt">group =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>), <span class="dt">score =</span> <span class="kw">c</span>(<span class="dv">99</span>, <span class="dv">97</span>, <span class="dv">99</span>)))</span>
<span id="cb17-2"><a href="reading-and-writing-data.html#cb17-2"></a><span class="kw">write_feather</span>(my_table, <span class="st">&quot;my_table.arrow&quot;</span>)</span></code></pre></div>
</div>
<div id="discussion-2" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.8.2</span> Discussion<a href="reading-and-writing-data.html#discussion-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For legacy support, you can write data in the original Feather format by setting the <code>version</code> parameter to <code>1</code>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="reading-and-writing-data.html#cb18-1"></a><span class="co"># Create table</span></span>
<span id="cb18-2"><a href="reading-and-writing-data.html#cb18-2"></a>my_table &lt;-<span class="st"> </span><span class="kw">arrow_table</span>(<span class="kw">data.frame</span>(<span class="dt">group =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>), <span class="dt">score =</span> <span class="kw">c</span>(<span class="dv">99</span>, <span class="dv">97</span>, <span class="dv">99</span>)))</span>
<span id="cb18-3"><a href="reading-and-writing-data.html#cb18-3"></a><span class="co"># Write to Feather format V1</span></span>
<span id="cb18-4"><a href="reading-and-writing-data.html#cb18-4"></a><span class="kw">write_feather</span>(mtcars, <span class="st">&quot;my_table.feather&quot;</span>, <span class="dt">version =</span> <span class="dv">1</span>)</span></code></pre></div>
</div>
</div>
<div id="read-a-feather-file" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.9</span> Read a Feather file<a href="reading-and-writing-data.html#read-a-feather-file" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You want to read a Feather file.</p>
<div id="solution-7" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.9.1</span> Solution<a href="reading-and-writing-data.html#solution-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="reading-and-writing-data.html#cb19-1"></a>my_feather_tbl &lt;-<span class="st"> </span><span class="kw">read_feather</span>(<span class="st">&quot;my_table.arrow&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="write-streaming-ipc-files" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.10</span> Write streaming IPC files<a href="reading-and-writing-data.html#write-streaming-ipc-files" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You want to write to the IPC stream format.</p>
<div id="solution-8" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.10.1</span> Solution<a href="reading-and-writing-data.html#solution-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="reading-and-writing-data.html#cb20-1"></a><span class="co"># Create table</span></span>
<span id="cb20-2"><a href="reading-and-writing-data.html#cb20-2"></a>my_table &lt;-<span class="st"> </span><span class="kw">arrow_table</span>(</span>
<span id="cb20-3"><a href="reading-and-writing-data.html#cb20-3"></a>  <span class="kw">data.frame</span>(</span>
<span id="cb20-4"><a href="reading-and-writing-data.html#cb20-4"></a>    <span class="dt">group =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>),</span>
<span id="cb20-5"><a href="reading-and-writing-data.html#cb20-5"></a>    <span class="dt">score =</span> <span class="kw">c</span>(<span class="dv">99</span>, <span class="dv">97</span>, <span class="dv">99</span>)</span>
<span id="cb20-6"><a href="reading-and-writing-data.html#cb20-6"></a>    )</span>
<span id="cb20-7"><a href="reading-and-writing-data.html#cb20-7"></a>)</span>
<span id="cb20-8"><a href="reading-and-writing-data.html#cb20-8"></a><span class="co"># Write to IPC stream format</span></span>
<span id="cb20-9"><a href="reading-and-writing-data.html#cb20-9"></a><span class="kw">write_ipc_stream</span>(my_table, <span class="st">&quot;my_table.arrows&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="read-streaming-ipc-files" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.11</span> Read streaming IPC files<a href="reading-and-writing-data.html#read-streaming-ipc-files" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You want to read from the IPC stream format.</p>
<div id="solution-9" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.11.1</span> Solution<a href="reading-and-writing-data.html#solution-9" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="reading-and-writing-data.html#cb21-1"></a>my_ipc_stream &lt;-<span class="st"> </span>arrow<span class="op">::</span><span class="kw">read_ipc_stream</span>(<span class="st">&quot;my_table.arrows&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="read-csv-files" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.12</span> Read CSV files<a href="reading-and-writing-data.html#read-csv-files" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You want to write Arrow data to a CSV file.</p>
<div id="solution-10" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.12.1</span> Solution<a href="reading-and-writing-data.html#solution-10" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="reading-and-writing-data.html#cb22-1"></a><span class="kw">write_csv_arrow</span>(cars, <span class="st">&quot;cars.csv&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="write-csv-files" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.13</span> Write CSV files<a href="reading-and-writing-data.html#write-csv-files" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You want to read a CSV file.</p>
<div id="solution-11" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.13.1</span> Solution<a href="reading-and-writing-data.html#solution-11" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="reading-and-writing-data.html#cb23-1"></a>my_csv &lt;-<span class="st"> </span><span class="kw">read_csv_arrow</span>(<span class="st">&quot;cars.csv&quot;</span>, <span class="dt">as_data_frame =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
</div>
</div>
<div id="read-json-files" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.14</span> Read JSON files<a href="reading-and-writing-data.html#read-json-files" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You want to read a JSON file.</p>
<div id="solution-12" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.14.1</span> Solution<a href="reading-and-writing-data.html#solution-12" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="reading-and-writing-data.html#cb24-1"></a><span class="co"># Create a file to read back in </span></span>
<span id="cb24-2"><a href="reading-and-writing-data.html#cb24-2"></a>tf &lt;-<span class="st"> </span><span class="kw">tempfile</span>()</span>
<span id="cb24-3"><a href="reading-and-writing-data.html#cb24-3"></a><span class="kw">writeLines</span>(<span class="st">&#39;</span></span>
<span id="cb24-4"><a href="reading-and-writing-data.html#cb24-4"></a><span class="st">    {&quot;country&quot;: &quot;United Kingdom&quot;, &quot;code&quot;: &quot;GB&quot;, &quot;long&quot;: -3.44, &quot;lat&quot;: 55.38}</span></span>
<span id="cb24-5"><a href="reading-and-writing-data.html#cb24-5"></a><span class="st">    {&quot;country&quot;: &quot;France&quot;, &quot;code&quot;: &quot;FR&quot;, &quot;long&quot;: 2.21, &quot;lat&quot;: 46.23}</span></span>
<span id="cb24-6"><a href="reading-and-writing-data.html#cb24-6"></a><span class="st">    {&quot;country&quot;: &quot;Germany&quot;, &quot;code&quot;: &quot;DE&quot;, &quot;long&quot;: 10.45, &quot;lat&quot;: 51.17}</span></span>
<span id="cb24-7"><a href="reading-and-writing-data.html#cb24-7"></a><span class="st">  &#39;</span>, tf, <span class="dt">useBytes =</span> <span class="ot">TRUE</span>)</span>
<span id="cb24-8"><a href="reading-and-writing-data.html#cb24-8"></a></span>
<span id="cb24-9"><a href="reading-and-writing-data.html#cb24-9"></a><span class="co"># Read in the data</span></span>
<span id="cb24-10"><a href="reading-and-writing-data.html#cb24-10"></a>countries &lt;-<span class="st"> </span><span class="kw">read_json_arrow</span>(tf, <span class="dt">col_select =</span> <span class="kw">c</span>(<span class="st">&quot;country&quot;</span>, <span class="st">&quot;long&quot;</span>, <span class="st">&quot;lat&quot;</span>))</span>
<span id="cb24-11"><a href="reading-and-writing-data.html#cb24-11"></a>countries</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   country         long   lat
##   &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt;
## 1 United Kingdom -3.44  55.4
## 2 France          2.21  46.2
## 3 Germany        10.4   51.2</code></pre>
</div>
</div>
<div id="write-partitioned-data" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.15</span> Write partitioned data<a href="reading-and-writing-data.html#write-partitioned-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You want to save data to disk in partitions based on columns in the data.</p>
<div id="solution-13" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.15.1</span> Solution<a href="reading-and-writing-data.html#solution-13" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="reading-and-writing-data.html#cb26-1"></a><span class="kw">write_dataset</span>(airquality, <span class="st">&quot;airquality_partitioned&quot;</span>, <span class="dt">partitioning =</span> <span class="kw">c</span>(<span class="st">&quot;Month&quot;</span>, <span class="st">&quot;Day&quot;</span>))</span>
<span id="cb26-2"><a href="reading-and-writing-data.html#cb26-2"></a><span class="kw">list.files</span>(<span class="st">&quot;airquality_partitioned&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Month=5&quot; &quot;Month=6&quot; &quot;Month=7&quot; &quot;Month=8&quot; &quot;Month=9&quot;</code></pre>
<p>As you can see, this has created folders based on the first partition variable supplied, <code>Month</code>.</p>
<p>If you take a look in one of these folders, you will see that the data is then partitioned by the second partition variable, <code>Day</code>.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="reading-and-writing-data.html#cb28-1"></a><span class="kw">list.files</span>(<span class="st">&quot;airquality_partitioned/Month=5&quot;</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;Day=1&quot;  &quot;Day=10&quot; &quot;Day=11&quot; &quot;Day=12&quot; &quot;Day=13&quot; &quot;Day=14&quot; &quot;Day=15&quot; &quot;Day=16&quot;
##  [9] &quot;Day=17&quot; &quot;Day=18&quot; &quot;Day=19&quot; &quot;Day=2&quot;  &quot;Day=20&quot; &quot;Day=21&quot; &quot;Day=22&quot; &quot;Day=23&quot;
## [17] &quot;Day=24&quot; &quot;Day=25&quot; &quot;Day=26&quot; &quot;Day=27&quot; &quot;Day=28&quot; &quot;Day=29&quot; &quot;Day=3&quot;  &quot;Day=30&quot;
## [25] &quot;Day=31&quot; &quot;Day=4&quot;  &quot;Day=5&quot;  &quot;Day=6&quot;  &quot;Day=7&quot;  &quot;Day=8&quot;  &quot;Day=9&quot;</code></pre>
<p>Each of these folders contains 1 or more Parquet files containing the relevant partition of the data.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="reading-and-writing-data.html#cb30-1"></a><span class="kw">list.files</span>(<span class="st">&quot;airquality_partitioned/Month=5/Day=10&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;part-0.parquet&quot;</code></pre>
</div>
</div>
<div id="read-partitioned-data" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.16</span> Read partitioned data<a href="reading-and-writing-data.html#read-partitioned-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You want to read partitioned data.</p>
<div id="solution-14" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.16.1</span> Solution<a href="reading-and-writing-data.html#solution-14" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="reading-and-writing-data.html#cb32-1"></a><span class="co"># Read data from directory</span></span>
<span id="cb32-2"><a href="reading-and-writing-data.html#cb32-2"></a>air_data &lt;-<span class="st"> </span><span class="kw">open_dataset</span>(<span class="st">&quot;airquality_partitioned&quot;</span>)</span>
<span id="cb32-3"><a href="reading-and-writing-data.html#cb32-3"></a></span>
<span id="cb32-4"><a href="reading-and-writing-data.html#cb32-4"></a><span class="co"># View data</span></span>
<span id="cb32-5"><a href="reading-and-writing-data.html#cb32-5"></a>air_data</span></code></pre></div>
<pre><code>## FileSystemDataset with 153 Parquet files
## Ozone: int32
## Solar.R: int32
## Wind: double
## Temp: int32
## Month: int32
## Day: int32
## 
## See $metadata for additional Schema metadata</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="reading-and-writing-data.html#cb34-1"></a><span class="kw">unlink</span>(<span class="st">&quot;airquality_partitioned&quot;</span>, <span class="dt">recursive =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
</div>
</div>
<div id="write-compressed-data" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.17</span> Write compressed data<a href="reading-and-writing-data.html#write-compressed-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You want to save a file, compressed with a specified compression algorithm.</p>
<div id="solution-15" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.17.1</span> Solution<a href="reading-and-writing-data.html#solution-15" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="reading-and-writing-data.html#cb35-1"></a><span class="co"># Create a temporary directory</span></span>
<span id="cb35-2"><a href="reading-and-writing-data.html#cb35-2"></a>td &lt;-<span class="st"> </span><span class="kw">tempfile</span>()</span>
<span id="cb35-3"><a href="reading-and-writing-data.html#cb35-3"></a><span class="kw">dir.create</span>(td)</span>
<span id="cb35-4"><a href="reading-and-writing-data.html#cb35-4"></a></span>
<span id="cb35-5"><a href="reading-and-writing-data.html#cb35-5"></a><span class="co"># Write data compressed with the gzip algorithm instead of the default</span></span>
<span id="cb35-6"><a href="reading-and-writing-data.html#cb35-6"></a><span class="kw">write_parquet</span>(iris, <span class="kw">file.path</span>(td, <span class="st">&quot;iris.parquet&quot;</span>), <span class="dt">compression =</span> <span class="st">&quot;gzip&quot;</span>)</span></code></pre></div>
</div>
<div id="discussion-3" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.17.2</span> Discussion<a href="reading-and-writing-data.html#discussion-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Note that <code>write_parquet()</code> by default already uses compression. See
<code>default_parquet_compression()</code> to see what the default configured on your
machine is.</p>
<p>You can also supply the <code>compression</code> argument to <code>write_dataset()</code>, as long as
the compression algorithm is compatible with the chosen format.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="reading-and-writing-data.html#cb36-1"></a><span class="co"># Create a temporary directory</span></span>
<span id="cb36-2"><a href="reading-and-writing-data.html#cb36-2"></a>td &lt;-<span class="st"> </span><span class="kw">tempfile</span>()</span>
<span id="cb36-3"><a href="reading-and-writing-data.html#cb36-3"></a><span class="kw">dir.create</span>(td)</span>
<span id="cb36-4"><a href="reading-and-writing-data.html#cb36-4"></a></span>
<span id="cb36-5"><a href="reading-and-writing-data.html#cb36-5"></a><span class="co"># Write dataset to file</span></span>
<span id="cb36-6"><a href="reading-and-writing-data.html#cb36-6"></a><span class="kw">write_dataset</span>(iris, <span class="dt">path =</span> td, <span class="dt">compression =</span> <span class="st">&quot;gzip&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="reading-and-writing-data.html#cb37-1"></a><span class="co"># View files in the directory</span></span>
<span id="cb37-2"><a href="reading-and-writing-data.html#cb37-2"></a><span class="kw">list.files</span>(td, <span class="dt">recursive =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;part-0.parquet&quot;</code></pre>
</div>
<div id="see-also-1" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.17.3</span> See also<a href="reading-and-writing-data.html#see-also-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Some formats write compressed data by default. For more information
on the supported compression algorithms and default settings, see:</p>
<ul>
<li><code>?write_parquet()</code></li>
<li><code>?write_feather()</code></li>
<li><code>?write_dataset()</code></li>
</ul>
</div>
</div>
<div id="read-compressed-data" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.18</span> Read compressed data<a href="reading-and-writing-data.html#read-compressed-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You want to read in data which has been compressed.</p>
<div id="solution-16" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.18.1</span> Solution<a href="reading-and-writing-data.html#solution-16" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="reading-and-writing-data.html#cb39-1"></a><span class="co"># Create a temporary directory</span></span>
<span id="cb39-2"><a href="reading-and-writing-data.html#cb39-2"></a>td &lt;-<span class="st"> </span><span class="kw">tempfile</span>()</span>
<span id="cb39-3"><a href="reading-and-writing-data.html#cb39-3"></a><span class="kw">dir.create</span>(td)</span>
<span id="cb39-4"><a href="reading-and-writing-data.html#cb39-4"></a></span>
<span id="cb39-5"><a href="reading-and-writing-data.html#cb39-5"></a><span class="co"># Write dataset which is to be read back in</span></span>
<span id="cb39-6"><a href="reading-and-writing-data.html#cb39-6"></a><span class="kw">write_parquet</span>(iris, <span class="kw">file.path</span>(td, <span class="st">&quot;iris.parquet&quot;</span>), <span class="dt">compression =</span> <span class="st">&quot;gzip&quot;</span>)</span>
<span id="cb39-7"><a href="reading-and-writing-data.html#cb39-7"></a></span>
<span id="cb39-8"><a href="reading-and-writing-data.html#cb39-8"></a><span class="co"># Read in data</span></span>
<span id="cb39-9"><a href="reading-and-writing-data.html#cb39-9"></a>ds &lt;-<span class="st"> </span><span class="kw">read_parquet</span>(<span class="kw">file.path</span>(td, <span class="st">&quot;iris.parquet&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb39-10"><a href="reading-and-writing-data.html#cb39-10"></a><span class="st">  </span><span class="kw">collect</span>()</span>
<span id="cb39-11"><a href="reading-and-writing-data.html#cb39-11"></a></span>
<span id="cb39-12"><a href="reading-and-writing-data.html#cb39-12"></a>ds</span></code></pre></div>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
## 1            5.1         3.5          1.4         0.2     setosa
## 2            4.9         3.0          1.4         0.2     setosa
## 3            4.7         3.2          1.3         0.2     setosa
## 4            4.6         3.1          1.5         0.2     setosa
## 5            5.0         3.6          1.4         0.2     setosa
## 6            5.4         3.9          1.7         0.4     setosa
## 7            4.6         3.4          1.4         0.3     setosa
## 8            5.0         3.4          1.5         0.2     setosa
## 9            4.4         2.9          1.4         0.2     setosa
## 10           4.9         3.1          1.5         0.1     setosa
## 11           5.4         3.7          1.5         0.2     setosa
## 12           4.8         3.4          1.6         0.2     setosa
## 13           4.8         3.0          1.4         0.1     setosa
## 14           4.3         3.0          1.1         0.1     setosa
## 15           5.8         4.0          1.2         0.2     setosa
## 16           5.7         4.4          1.5         0.4     setosa
## 17           5.4         3.9          1.3         0.4     setosa
## 18           5.1         3.5          1.4         0.3     setosa
## 19           5.7         3.8          1.7         0.3     setosa
## 20           5.1         3.8          1.5         0.3     setosa
## 21           5.4         3.4          1.7         0.2     setosa
## 22           5.1         3.7          1.5         0.4     setosa
## 23           4.6         3.6          1.0         0.2     setosa
## 24           5.1         3.3          1.7         0.5     setosa
## 25           4.8         3.4          1.9         0.2     setosa
## 26           5.0         3.0          1.6         0.2     setosa
## 27           5.0         3.4          1.6         0.4     setosa
## 28           5.2         3.5          1.5         0.2     setosa
## 29           5.2         3.4          1.4         0.2     setosa
## 30           4.7         3.2          1.6         0.2     setosa
## 31           4.8         3.1          1.6         0.2     setosa
## 32           5.4         3.4          1.5         0.4     setosa
## 33           5.2         4.1          1.5         0.1     setosa
## 34           5.5         4.2          1.4         0.2     setosa
## 35           4.9         3.1          1.5         0.2     setosa
## 36           5.0         3.2          1.2         0.2     setosa
## 37           5.5         3.5          1.3         0.2     setosa
## 38           4.9         3.6          1.4         0.1     setosa
## 39           4.4         3.0          1.3         0.2     setosa
## 40           5.1         3.4          1.5         0.2     setosa
## 41           5.0         3.5          1.3         0.3     setosa
## 42           4.5         2.3          1.3         0.3     setosa
## 43           4.4         3.2          1.3         0.2     setosa
## 44           5.0         3.5          1.6         0.6     setosa
## 45           5.1         3.8          1.9         0.4     setosa
## 46           4.8         3.0          1.4         0.3     setosa
## 47           5.1         3.8          1.6         0.2     setosa
## 48           4.6         3.2          1.4         0.2     setosa
## 49           5.3         3.7          1.5         0.2     setosa
## 50           5.0         3.3          1.4         0.2     setosa
## 51           7.0         3.2          4.7         1.4 versicolor
## 52           6.4         3.2          4.5         1.5 versicolor
## 53           6.9         3.1          4.9         1.5 versicolor
## 54           5.5         2.3          4.0         1.3 versicolor
## 55           6.5         2.8          4.6         1.5 versicolor
## 56           5.7         2.8          4.5         1.3 versicolor
## 57           6.3         3.3          4.7         1.6 versicolor
## 58           4.9         2.4          3.3         1.0 versicolor
## 59           6.6         2.9          4.6         1.3 versicolor
## 60           5.2         2.7          3.9         1.4 versicolor
## 61           5.0         2.0          3.5         1.0 versicolor
## 62           5.9         3.0          4.2         1.5 versicolor
## 63           6.0         2.2          4.0         1.0 versicolor
## 64           6.1         2.9          4.7         1.4 versicolor
## 65           5.6         2.9          3.6         1.3 versicolor
## 66           6.7         3.1          4.4         1.4 versicolor
## 67           5.6         3.0          4.5         1.5 versicolor
## 68           5.8         2.7          4.1         1.0 versicolor
## 69           6.2         2.2          4.5         1.5 versicolor
## 70           5.6         2.5          3.9         1.1 versicolor
## 71           5.9         3.2          4.8         1.8 versicolor
## 72           6.1         2.8          4.0         1.3 versicolor
## 73           6.3         2.5          4.9         1.5 versicolor
## 74           6.1         2.8          4.7         1.2 versicolor
## 75           6.4         2.9          4.3         1.3 versicolor
## 76           6.6         3.0          4.4         1.4 versicolor
## 77           6.8         2.8          4.8         1.4 versicolor
## 78           6.7         3.0          5.0         1.7 versicolor
## 79           6.0         2.9          4.5         1.5 versicolor
## 80           5.7         2.6          3.5         1.0 versicolor
## 81           5.5         2.4          3.8         1.1 versicolor
## 82           5.5         2.4          3.7         1.0 versicolor
## 83           5.8         2.7          3.9         1.2 versicolor
## 84           6.0         2.7          5.1         1.6 versicolor
## 85           5.4         3.0          4.5         1.5 versicolor
## 86           6.0         3.4          4.5         1.6 versicolor
## 87           6.7         3.1          4.7         1.5 versicolor
## 88           6.3         2.3          4.4         1.3 versicolor
## 89           5.6         3.0          4.1         1.3 versicolor
## 90           5.5         2.5          4.0         1.3 versicolor
## 91           5.5         2.6          4.4         1.2 versicolor
## 92           6.1         3.0          4.6         1.4 versicolor
## 93           5.8         2.6          4.0         1.2 versicolor
## 94           5.0         2.3          3.3         1.0 versicolor
## 95           5.6         2.7          4.2         1.3 versicolor
## 96           5.7         3.0          4.2         1.2 versicolor
## 97           5.7         2.9          4.2         1.3 versicolor
## 98           6.2         2.9          4.3         1.3 versicolor
## 99           5.1         2.5          3.0         1.1 versicolor
## 100          5.7         2.8          4.1         1.3 versicolor
## 101          6.3         3.3          6.0         2.5  virginica
## 102          5.8         2.7          5.1         1.9  virginica
## 103          7.1         3.0          5.9         2.1  virginica
## 104          6.3         2.9          5.6         1.8  virginica
## 105          6.5         3.0          5.8         2.2  virginica
## 106          7.6         3.0          6.6         2.1  virginica
## 107          4.9         2.5          4.5         1.7  virginica
## 108          7.3         2.9          6.3         1.8  virginica
## 109          6.7         2.5          5.8         1.8  virginica
## 110          7.2         3.6          6.1         2.5  virginica
## 111          6.5         3.2          5.1         2.0  virginica
## 112          6.4         2.7          5.3         1.9  virginica
## 113          6.8         3.0          5.5         2.1  virginica
## 114          5.7         2.5          5.0         2.0  virginica
## 115          5.8         2.8          5.1         2.4  virginica
## 116          6.4         3.2          5.3         2.3  virginica
## 117          6.5         3.0          5.5         1.8  virginica
## 118          7.7         3.8          6.7         2.2  virginica
## 119          7.7         2.6          6.9         2.3  virginica
## 120          6.0         2.2          5.0         1.5  virginica
## 121          6.9         3.2          5.7         2.3  virginica
## 122          5.6         2.8          4.9         2.0  virginica
## 123          7.7         2.8          6.7         2.0  virginica
## 124          6.3         2.7          4.9         1.8  virginica
## 125          6.7         3.3          5.7         2.1  virginica
## 126          7.2         3.2          6.0         1.8  virginica
## 127          6.2         2.8          4.8         1.8  virginica
## 128          6.1         3.0          4.9         1.8  virginica
## 129          6.4         2.8          5.6         2.1  virginica
## 130          7.2         3.0          5.8         1.6  virginica
## 131          7.4         2.8          6.1         1.9  virginica
## 132          7.9         3.8          6.4         2.0  virginica
## 133          6.4         2.8          5.6         2.2  virginica
## 134          6.3         2.8          5.1         1.5  virginica
## 135          6.1         2.6          5.6         1.4  virginica
## 136          7.7         3.0          6.1         2.3  virginica
## 137          6.3         3.4          5.6         2.4  virginica
## 138          6.4         3.1          5.5         1.8  virginica
## 139          6.0         3.0          4.8         1.8  virginica
## 140          6.9         3.1          5.4         2.1  virginica
## 141          6.7         3.1          5.6         2.4  virginica
## 142          6.9         3.1          5.1         2.3  virginica
## 143          5.8         2.7          5.1         1.9  virginica
## 144          6.8         3.2          5.9         2.3  virginica
## 145          6.7         3.3          5.7         2.5  virginica
## 146          6.7         3.0          5.2         2.3  virginica
## 147          6.3         2.5          5.0         1.9  virginica
## 148          6.5         3.0          5.2         2.0  virginica
## 149          6.2         3.4          5.4         2.3  virginica
## 150          5.9         3.0          5.1         1.8  virginica</code></pre>
</div>
<div id="discussion-4" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.18.2</span> Discussion<a href="reading-and-writing-data.html#discussion-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Note that Arrow automatically detects the compression and you do not have to
supply it in the call to <code>open_dataset()</code> or the <code>read_*()</code> functions.</p>
<p>Although the CSV format does not support compression itself, Arrow supports
reading in CSV data which has been compressed, if the file extension is <code>.gz</code>.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="reading-and-writing-data.html#cb41-1"></a><span class="co"># Create a temporary directory</span></span>
<span id="cb41-2"><a href="reading-and-writing-data.html#cb41-2"></a>td &lt;-<span class="st"> </span><span class="kw">tempfile</span>()</span>
<span id="cb41-3"><a href="reading-and-writing-data.html#cb41-3"></a><span class="kw">dir.create</span>(td)</span>
<span id="cb41-4"><a href="reading-and-writing-data.html#cb41-4"></a></span>
<span id="cb41-5"><a href="reading-and-writing-data.html#cb41-5"></a><span class="co"># Write dataset which is to be read back in</span></span>
<span id="cb41-6"><a href="reading-and-writing-data.html#cb41-6"></a><span class="kw">write.csv</span>(iris, <span class="kw">gzfile</span>(<span class="kw">file.path</span>(td, <span class="st">&quot;iris.csv.gz&quot;</span>)), <span class="dt">row.names =</span> <span class="ot">FALSE</span>, <span class="dt">quote =</span> <span class="ot">FALSE</span>)</span>
<span id="cb41-7"><a href="reading-and-writing-data.html#cb41-7"></a></span>
<span id="cb41-8"><a href="reading-and-writing-data.html#cb41-8"></a><span class="co"># Read in data</span></span>
<span id="cb41-9"><a href="reading-and-writing-data.html#cb41-9"></a>ds &lt;-<span class="st"> </span><span class="kw">open_dataset</span>(td, <span class="dt">format =</span> <span class="st">&quot;csv&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb41-10"><a href="reading-and-writing-data.html#cb41-10"></a><span class="st">  </span><span class="kw">collect</span>()</span>
<span id="cb41-11"><a href="reading-and-writing-data.html#cb41-11"></a>ds</span></code></pre></div>
<pre><code>## # A tibble: 150 × 5
##    Sepal.Length Sepal.Width Petal.Length Petal.Width Species
##           &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;  
##  1          5.1         3.5          1.4         0.2 setosa 
##  2          4.9         3            1.4         0.2 setosa 
##  3          4.7         3.2          1.3         0.2 setosa 
##  4          4.6         3.1          1.5         0.2 setosa 
##  5          5           3.6          1.4         0.2 setosa 
##  6          5.4         3.9          1.7         0.4 setosa 
##  7          4.6         3.4          1.4         0.3 setosa 
##  8          5           3.4          1.5         0.2 setosa 
##  9          4.4         2.9          1.4         0.2 setosa 
## 10          4.9         3.1          1.5         0.1 setosa 
## # … with 140 more rows</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="creating-arrow-objects.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/apache/arrow-cookbook/edit/main/r/content/reading_and_writing_data.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
